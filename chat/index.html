<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test chat</title>
  </head>
  <body>
    <input type="text" name="message" id="message" />
    <button id="send">Ã§a va ?</button>

    <script src="./socket.io.js"></script>
    <script>
      const socket = io("http://localhost:3000", {
        query: {
          token:
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MTUsImVtYWlsIjoiYWRtaW5AZG0uaW4iLCJzbHVnIjoiYWRtaW4tYWRtaW4iLCJpc0FkbWluIjp0cnVlLCJpYXQiOjE1OTg5ODI2ODEsImV4cCI6MTU5ODk4Mzg4MX0.QsQNcnw4oRUmD38-UFkpw5pEbrIt_FFsop9QqPbhGUo"
        }
      });

      socket.on("connect", () => {
        console.log("connected socket");
      });

      socket.on("error", err => {
        console.log(err);
      });

      socket.on("message", data => {
        console.log(data);
        const p = document.createElement("p");
        p.innerText = data.text;
        document.body.appendChild(p);
      });

      document.getElementById("send").addEventListener("click", () => {
        socket.emit("message", {
          text: document.getElementById("message").value,
          recipient_id: 14
        });
      });
    </script>
  </body>
</html>
